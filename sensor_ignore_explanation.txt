/*
================ PERBEDAAN AUTO vs MANUAL PANEL MODE ================

SKENARIO: Sensor1 berubah dari HIGH ke LOW (ada tegangan terdeteksi)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AUTO MODE (Sensor Aktif)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Sensor1: HIGH â†’ LOW                                              â”‚
â”‚ 2. ESP32: "Sensor1 LOW detected"                                    â”‚
â”‚ 3. Logic: if (!voltage1Detected) { activateContractor(1); }        â”‚
â”‚ 4. Action: Kontaktor 1 OTOMATIS ON                                  â”‚
â”‚ 5. Result: Lampu menyala tanpa campur tangan manusia               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MANUAL PANEL MODE (Sensor Diabaikan)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Sensor1: HIGH â†’ LOW                                              â”‚
â”‚ 2. ESP32: "Sensor1 LOW detected - IGNORED in manual mode"          â”‚
â”‚ 3. Logic: Sensor logic di-skip, tidak eksekusi aktivasi            â”‚
â”‚ 4. Action: Kontaktor 1 TIDAK berubah (tetap OFF)                   â”‚
â”‚ 5. Result: Operator harus tekan push button untuk nyalakan lampu   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

KODE IMPLEMENTATION:
===================
*/

void checkVoltageDetectors() {
  // Sensor tetap dibaca (untuk monitoring dan display)
  voltage1Detected = digitalRead(sensor1) == HIGH;
  voltage2Detected = digitalRead(sensor2) == HIGH;

  Serial.print("Sensor: ");
  Serial.print("S1:" + String(voltage1Detected ? "HIGH " : "LOW "));
  Serial.print("S2:" + String(voltage2Detected ? "HIGH " : "LOW "));
  
  // KONTROL LOGIC - Bergantung mode
  if (autoModeEnabled) {
    // ========== AUTO MODE: SENSOR MENGONTROL KONTAKTOR ==========
    Serial.print(" | ğŸ¤– AUTO MODE");
    
    bool oldContractor1 = contractor1State;
    bool oldContractor2 = contractor2State;
    
    // Sensor 1 â†’ Kontaktor 1 (OTOMATIS)
    if (voltage1Detected) {
      if (contractor1State) {
        deactivateContractor(1);
        Serial.print(" | S1â†’K1:OFF");
      }
    } else {
      if (!contractor1State) {
        activateContractor(1);  // â† SENSOR MENGONTROL
        Serial.print(" | S1â†’K1:ON");
      }
    }
    
    // Sensor 2 â†’ Kontaktor 2 (OTOMATIS)
    if (voltage2Detected) {
      if (contractor2State) {
        deactivateContractor(2);
        Serial.print(" | S2â†’K2:OFF");
      }
    } else {
      if (!contractor2State) {
        activateContractor(2);  // â† SENSOR MENGONTROL
        Serial.print(" | S2â†’K2:ON");
      }
    }
    
  } else {
    // ========== MANUAL MODE: SENSOR DIABAIKAN ==========
    Serial.print(" | ğŸ‘¤ MANUAL PANEL MODE");
    Serial.print(" | Sensors READ but IGNORED for control");
    
    // Sensor logic di-skip
    // Tidak ada activateContractor() atau deactivateContractor() dari sensor
    // Hanya push button yang bisa kontrol kontaktor
  }
  
  Serial.println();
  
  // Update display (sensor tetap ditampilkan untuk monitoring)
  Blynk.virtualWrite(V121, voltage1Detected ? 1 : 0);  // Sensor status
  Blynk.virtualWrite(V122, voltage2Detected ? 1 : 0);  // Sensor status
  Blynk.virtualWrite(V113, contractor1State ? 1 : 0);   // Kontaktor status
  Blynk.virtualWrite(V114, contractor2State ? 1 : 0);   // Kontaktor status
}

/*
PENGERTIAN "DIABAIKAN":
======================

âŒ BUKAN berarti sensor tidak dibaca
âŒ BUKAN berarti sensor rusak atau mati

âœ… Sensor TETAP dibaca (untuk monitoring & display)
âœ… Sensor TIDAK mengeksekusi kontrol kontaktor
âœ… Hanya push button yang bisa kontrol kontaktor
âœ… Operator punya kontrol penuh

ANALOGI SEDERHANA:
==================

AUTO MODE = Mobil Self-Driving
- Sensor jalan mendeteksi â†’ mobil belok otomatis
- Driver tidak perlu kontrol

MANUAL MODE = Mobil Manual
- Sensor jalan tetap membaca kondisi jalan
- Tapi driver yang harus belok sendiri
- Sensor hanya untuk informasi

KEUNTUNGAN MANUAL MODE:
======================
âœ… Kontrol penuh operator
âœ… Bypass sensor yang error
âœ… Operasi darurat
âœ… Testing individual kontaktor
âœ… Maintenance mode
âœ… Override otomasi jika diperlukan

SKENARIO PENGGUNAAN:
===================

Contoh 1: Sensor Rusak
- Auto mode: Kontaktor tidak akan nyala (sensor error)
- Manual mode: Operator masih bisa nyalakan dengan push button

Contoh 2: Testing
- Auto mode: Harus simulate sensor condition
- Manual mode: Langsung test kontaktor tanpa sensor

Contoh 3: Emergency
- Auto mode: Menunggu sensor condition
- Manual mode: Immediate control by operator
*/